DRIVER - Debug mode enabled
BROKER<zone_1> - Successfully initialized broker object (BROKER140570511505728)
BROKER<zone_1> - Try to connect with ZooKeeper server: hosts = 10.0.0.1:2181
BROKER<zone_1> - ZooKeeper Current Status = LOST
BROKER<zone_1> - Current state is now = CONNECTED
BROKER<zone_1> - Setting up shared state znode for multiple primary brokers
BROKER<zone_1> - initializing /primaries/ znode if not exists
BROKER<zone_1> - Publishers shared state changed!
BROKER<zone_1> - Subscribers shared state changed!
BROKER<zone_1,backup> - I am currently a contender/backup for zone_1
BROKER<zone_1,backup> - contenders for /elections/zone_1: ['bdfcf0aa-65a2-4ef8-9817-c9a75fdae323']
BROKER<zone_1,backup> - Publishers shared state changed!
BROKER<zone_1,backup> - New publisher 140436547410240
BROKER<zone_1,backup> - Checking if Znode /shared_state/publishers/140436547410240 exists
BROKER<zone_1,backup> - Details of znode /shared_state/publishers/140436547410240: value = b'{"address": "10.0.0.7:5556", "offered": 1, "id": "140436547410240", "topics": ["A", "B", "C"]}', stat = ZnodeStat(czxid=109521, mzxid=109521, ctime=1627347867165, mtime=1627347867165, version=0, cversion=0, aversion=0, ephemeralOwner=0, dataLength=94, numChildren=0, pzxid=109521)
BROKER<zone_1,backup> - New pub info: {"address": "10.0.0.7:5556", "offered": 1, "id": "140436547410240", "topics": ["A", "B", "C"]}
BROKER<zone_1,backup> - Adding publisher to publishers[A]
BROKER<zone_1,backup> - Adding publisher to publishers[B]
BROKER<zone_1,backup> - Adding publisher to publishers[C]
BROKER<zone_1,backup> - Notifying subscribers
BROKER<zone_1,backup> - Subscribers shared state changed!
BROKER<zone_1,backup> - New subscriber! 139811911027008
BROKER<zone_1,backup> - Checking if Znode /shared_state/subscribers/139811911027008 exists
BROKER<zone_1,backup> - Details of znode /shared_state/subscribers/139811911027008: value = b'{"address": "10.0.0.6", "requested": 1, "id": "139811911027008", "topics": ["A", "B", "C"]}', stat = ZnodeStat(czxid=109526, mzxid=109526, ctime=1627347867728, mtime=1627347867728, version=0, cversion=0, aversion=0, ephemeralOwner=0, dataLength=91, numChildren=0, pzxid=109526)
BROKER<zone_1,backup> - New sub info: {"address": "10.0.0.6", "requested": 1, "id": "139811911027008", "topics": ["A", "B", "C"]}
BROKER<zone_1,backup> - Adding sub to subscribers[A]
BROKER<zone_1,backup> - Adding sub to subscribers[B]
BROKER<zone_1,backup> - Adding sub to subscribers[C]
BROKER<zone_1,backup> - Publishers shared state changed!
BROKER<zone_1,backup> - New publisher 140689472907584
BROKER<zone_1,backup> - Checking if Znode /shared_state/publishers/140689472907584 exists
BROKER<zone_1,backup> - Details of znode /shared_state/publishers/140689472907584: value = b'{"address": "10.0.0.8:5556", "offered": 1, "id": "140689472907584", "topics": ["A", "B", "C"]}', stat = ZnodeStat(czxid=109528, mzxid=109528, ctime=1627347867782, mtime=1627347867782, version=0, cversion=0, aversion=0, ephemeralOwner=0, dataLength=94, numChildren=0, pzxid=109528)
BROKER<zone_1,backup> - New pub info: {"address": "10.0.0.8:5556", "offered": 1, "id": "140689472907584", "topics": ["A", "B", "C"]}
BROKER<zone_1,backup> - Adding publisher to publishers[A]
BROKER<zone_1,backup> - Adding publisher to publishers[B]
BROKER<zone_1,backup> - Adding publisher to publishers[C]
BROKER<zone_1,backup> - Notifying subscribers
BROKER<zone_1,backup> - Subscribers shared state changed!
BROKER<zone_1,backup> - New subscriber! 140069863315776
BROKER<zone_1,backup> - Checking if Znode /shared_state/subscribers/140069863315776 exists
BROKER<zone_1,backup> - Details of znode /shared_state/subscribers/140069863315776: value = b'{"address": "10.0.0.5", "requested": 1, "id": "140069863315776", "topics": ["A", "B", "C"]}', stat = ZnodeStat(czxid=109569, mzxid=109569, ctime=1627347868583, mtime=1627347868583, version=0, cversion=0, aversion=0, ephemeralOwner=0, dataLength=91, numChildren=0, pzxid=109569)
BROKER<zone_1,backup> - New sub info: {"address": "10.0.0.5", "requested": 1, "id": "140069863315776", "topics": ["A", "B", "C"]}
BROKER<zone_1,backup> - Adding sub to subscribers[A]
BROKER<zone_1,backup> - Adding sub to subscribers[B]
BROKER<zone_1,backup> - Adding sub to subscribers[C]
BROKER<zone_1,backup> - Subscribers shared state changed!
BROKER<zone_1,backup> - Removing subscriber 139811911027008
BROKER<zone_1,backup> - Removing subscriber 139811911027008
BROKER<zone_1,backup> - Removing subscriber 139811911027008
BROKER<zone_1,backup> - Subscribers shared state changed!
BROKER<zone_1,backup> - Removing subscriber 140069863315776
BROKER<zone_1,backup> - Removing subscriber 140069863315776
BROKER<zone_1,backup> - Removing subscriber 140069863315776
BROKER<zone_1,primary> - I (ebf285be-6c44-462c-904a-28826dbed305) AM LEADER OF /elections/zone_1
BROKER<zone_1,primary> - Storing my information in /primaries/zone_1
BROKER<zone_1,primary> - Configuring myself!
BROKER<zone_1,primary> - Configure Start
BROKER<zone_1,primary> - Opening two REP sockets for publisher registration and subscriber registration
BROKER<zone_1,primary> - Attempting bind to port 5555
BROKER<zone_1,primary> - Successful bind to port 5555
BROKER<zone_1,primary> - Attempting bind to port 5556
BROKER<zone_1,primary> - Successful bind to port 5556
BROKER<zone_1,primary> - Enabling publisher registration on port 5555
BROKER<zone_1,primary> - Enabling subscriber registration on port 5556
BROKER<zone_1,primary> - Register sockets with a ZMQ poller
BROKER<zone_1,primary> - Configure Stop
BROKER<zone_1,primary> - /primaries/zone_1 znode exists : only modify the value)
BROKER<zone_1,primary> - Setting a new value = 10.0.0.4,5555,5556 on znode /primaries/zone_1
BROKER<zone_1,primary> - /primaries/zone_1 znode exists; setting a new value on it
BROKER<zone_1,primary> - New value at znode /primaries/zone_1: value = b'10.0.0.4,5555,5556', stat = ZnodeStat(czxid=109513, mzxid=112142, ctime=1627347866366, mtime=1627347881253, version=1, cversion=0, aversion=0, ephemeralOwner=0, dataLength=18, numChildren=0, pzxid=109513)
BROKER<zone_1,primary> - Updating current system load znode
BROKER<zone_1,primary> - Setting a new value = 2.0 on znode /shared_state/current_load
BROKER<zone_1,primary> - /shared_state/current_load znode exists; setting a new value on it
BROKER<zone_1,primary> - New value at znode /shared_state/current_load: value = b'2.0', stat = ZnodeStat(czxid=109507, mzxid=112145, ctime=1627347861955, mtime=1627347881290, version=8, cversion=0, aversion=0, ephemeralOwner=0, dataLength=3, numChildren=0, pzxid=109507)
BROKER<zone_1,primary> - Start Event Loop
BROKER<zone_1,primary> - Begin indefinite event poll loop
BROKER<zone_1,primary> - Publisher Registration Started: {
    "address": "10.0.0.7:5556",
    "topics": [
        "A",
        "B",
        "C"
    ],
    "id": "140436547410240",
    "offered": 1
}
BROKER<zone_1,primary> - Notifying subscribers
BROKER<zone_1,primary> - znode /shared_state/publishers/140436547410240 already exists
BROKER<zone_1,primary> - Setting a new value = 2.0 on znode /shared_state/current_load
BROKER<zone_1,primary> - /shared_state/current_load znode exists; setting a new value on it
BROKER<zone_1,primary> - New value at znode /shared_state/current_load: value = b'2.0', stat = ZnodeStat(czxid=109507, mzxid=112149, ctime=1627347861955, mtime=1627347881827, version=9, cversion=0, aversion=0, ephemeralOwner=0, dataLength=3, numChildren=0, pzxid=109507)
BROKER<zone_1,primary> - Sending response: {'success': 'registration success'}
BROKER<zone_1,primary> - Publisher Registration Succeeded
BROKER<zone_1,primary> - Publisher Registration Started: {
    "address": "10.0.0.8:5556",
    "topics": [
        "A",
        "B",
        "C"
    ],
    "id": "140689472907584",
    "offered": 1
}
BROKER<zone_1,primary> - Notifying subscribers
BROKER<zone_1,primary> - znode /shared_state/publishers/140689472907584 already exists
BROKER<zone_1,primary> - Setting a new value = 2.0 on znode /shared_state/current_load
BROKER<zone_1,primary> - /shared_state/current_load znode exists; setting a new value on it
BROKER<zone_1,primary> - New value at znode /shared_state/current_load: value = b'2.0', stat = ZnodeStat(czxid=109507, mzxid=112150, ctime=1627347861955, mtime=1627347881886, version=10, cversion=0, aversion=0, ephemeralOwner=0, dataLength=3, numChildren=0, pzxid=109507)
BROKER<zone_1,primary> - Sending response: {'success': 'registration success'}
BROKER<zone_1,primary> - Publisher Registration Succeeded
BROKER<zone_1,primary> - Publishers shared state changed!
BROKER<zone_1,primary> - Removing a publisher: 140436547410240
BROKER<zone_1,primary> - Removing publisher 140436547410240
BROKER<zone_1,primary> - Removing publisher 140436547410240
BROKER<zone_1,primary> - Removing publisher 140436547410240
BROKER<zone_1,primary> - Removing publisher 140436547410240
BROKER<zone_1,primary> - Removing publisher 140436547410240
BROKER<zone_1,primary> - Removing publisher 140436547410240
BROKER<zone_1,primary> - Removing a publisher: 140436547410240
BROKER<zone_1,primary> - Removing a publisher: 140436547410240
BROKER<zone_1,primary> - Removing a publisher: 140436547410240
BROKER<zone_1,primary> - Removing a publisher: 140436547410240
BROKER<zone_1,primary> - Removing a publisher: 140436547410240
BROKER<zone_1,primary> - Publishers shared state changed!
BROKER<zone_1,primary> - Removing a publisher: 140689472907584
BROKER<zone_1,primary> - Removing publisher 140689472907584
BROKER<zone_1,primary> - Removing publisher 140689472907584
BROKER<zone_1,primary> - Removing publisher 140689472907584
BROKER<zone_1,primary> - Removing a publisher: 140689472907584
BROKER<zone_1,primary> - Removing publisher 140689472907584
BROKER<zone_1,primary> - Removing publisher 140689472907584
BROKER<zone_1,primary> - Removing publisher 140689472907584
BROKER<zone_1,primary> - Removing a publisher: 140689472907584
BROKER<zone_1,primary> - Removing a publisher: 140689472907584
BROKER<zone_1,primary> - Removing a publisher: 140689472907584
BROKER<zone_1,primary> - Removing a publisher: 140689472907584
Connection dropped: socket connection broken
Transition to CONNECTING
BROKER<zone_1,primary> - Current state is now = SUSPENDED
Connection dropped: socket connection error: Connection refused
Connection dropped: socket connection error: Connection refused
Connection dropped: socket connection error: Connection refused
Connection dropped: socket connection error: Connection refused
Connection dropped: socket connection error: Connection refused
Connection dropped: socket connection error: Connection refused
